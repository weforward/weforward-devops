package cn.weforward.devops.user.impl;

import cn.weforward.devops.user.OrganizationProvider;
import cn.weforward.framework.ApiException;
import cn.weforward.framework.WeforwardSession;
import cn.weforward.framework.ext.UserAuthorizer;
import cn.weforward.protocol.Request;
import cn.weforward.protocol.ops.User;

public class OrganizationUserAuth extends UserAuthorizer {
	@Override
	public void auth(Request request) throws ApiException {
		WeforwardSession session = WeforwardSession.TLS.getSession();
		if (null != session) {
			User user = session.getUser();
			if (user instanceof SimpleUser) {
				SimpleUser su = (SimpleUser) user;
				OrganizationProvider.TLS.put(su.getOrganization());
			}
		}
	}
}
