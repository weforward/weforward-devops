(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b976ab2"],{2578:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("WoolShowmodal",{attrs:{isshow:t.isshow}},[s("div",{class:["cmd_modal","modal",!t.isDelete||"deleteHeight"]},[s("div",{staticClass:"modal-title"},[t._v(t._s(t.handelName)+" 执行提示")]),s("div",{staticClass:"modal-content"},[t._v("\n\t\t\t\t您确认要"),s("span",{staticStyle:{color:"#1862c6"}},[t._v(t._s(t.handelName))]),t.version?s("span",[t._v("版本号"+t._s(t.version)+"的")]):t._e(),t.isDelete?t._e():s("span",[t._v("实例")]),t.deleteName?s("span",[t._v(t._s(t.deleteName))]):t._e(),t._v(" 吗?\n\t\t\t\t"),t.isDelete?t._e():s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.note,expression:"note"}],staticClass:"note-input",attrs:{rows:"10",placeholder:"请输入备注说明（选填）"},domProps:{value:t.note},on:{input:function(e){e.target.composing||(t.note=e.target.value)}}})]),s("div",{staticClass:"handle"},[s("button",{staticClass:"add-btn",on:{click:t.reqeustHandle}},[t._v("确  认")]),s("button",{staticClass:"cancel-btn",on:{click:function(e){return t.$emit("toggle")}}},[t._v("取消")])])]),s("WoolShowmodal",{attrs:{isshow:t.showTask,isshowcloser:!0},on:{tapCloser:t.closeShowTask}},[s("div",{staticClass:"task"},[s("div",{staticClass:"tasktitle"},[s("span",{staticStyle:{color:"red"}},[t._v("●")]),s("span",{staticStyle:{color:"#FFC000"}},[t._v("●")]),s("span",{staticStyle:{color:"#2E75B6"}},[t._v("●")]),t._v(" 当前状态："+t._s(t.currentStatus.desc||"--"))]),s("div",{staticClass:"cmdscreen wt-scroll"},[s("ul",{ref:"taskList",staticClass:"task-list"},t._l(t.statusList,(function(e,n){return s("li",{key:n},[t._v(t._s(e.desc||"--"))])})),0)])])])],1)},a=[],i={name:"ReminderModel",components:{WoolShowmodal:function(){return s.e("chunk-41c82f40").then(s.bind(null,"59c5"))}},props:{handelName:{type:String},handleOp:{type:String},isshow:{type:Boolean,default:function(){return!1}},runningId:{type:String},version:{type:String},isDelete:{type:Boolean,default:function(){return!1}},deleteName:{type:String}},data:function(){return{note:"",msgView:null,isVersionsFail:!1,taskTimer:null,showTask:!1,taskId:"",currentStatus:{},statusList:[]}},methods:{reqeustHandle:function(){var t=this;this.isDelete?this.$emit("sure"):(this.msgView=this.$wool.showloading("正在"+this.handelName+"中"),this.$nextTick((function(){var e={op:t.handleOp,id:t.runningId,note:t.note};"upgrade"!=t.handleOp&&"build"!=t.handleOp||(e.version=t.version);var s="?method=/devops/home/running";t.$wf.post(s,e).then((function(e){return t.handleSucc(e)})).catch((function(e){return t.msgView.msgwarn(e.message).hide()}))})))},handleSucc:function(t){var e=this;this.taskId=t.id,this.taskTimer=setInterval((function(){e.requestTaskStatus()}),1e3),this.showTask=!0,t.id?(this.msgView.msgsucc(this.handelName+"操作成功").hide(),this.$emit("load")):this.msgView.msgwarn(this.handelName+"操作失败").hide()},requestTaskStatus:function(){var t=this,e="?method=/devops/home/optask",s={id:this.taskId};this.$wf.post(e,s).then((function(e){t.currentStatus=e.current_status||{},t.statusList=e.status,t.$nextTick((function(){t.$refs.taskList.scrollTop=t.$refs.taskList.scrollHeight})),console.log(t.currentStatus),e.done&&clearInterval(t.taskTimer)})).catch((function(e){t.$wool.showwarn(e.message)}))},closeShowTask:function(){clearInterval(this.taskTimer),this.showTask=!1,this.$emit("toggle")}}},o=i,l=(s("88e6"),s("2877")),r=Object(l["a"])(o,n,a,!1,null,"19b7634c",null);e["default"]=r.exports},"88e6":function(t,e,s){"use strict";var n=s("c358"),a=s.n(n);a.a},c358:function(t,e,s){}}]);