(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e8d83ca"],{3970:function(e,t,s){},"51f3":function(e,t,s){"use strict";s("3970")},5732:function(e,t,s){e.exports=s.p+"static/img/dele.f5a9b51f.png"},"68f0":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("WoolShowmodal",{attrs:{isshow:e.isshow,isshowcloser:!0},on:{tapCloser:function(t){return e.$emit("toggle")}}},[i("div",{staticClass:"addProject"},[i("div",{staticClass:"titlebar flexlayout"},["add"==e.operate?i("span",[e._v("添加项目")]):e._e(),"update"==e.operate?i("span",[e._v("修改项目")]):e._e(),"detail"==e.operate?i("span",[e._v("查看项目")]):e._e()]),i("div",{staticClass:"content wt-scroll"},[i("label",{staticClass:"flexlayout input-item",staticStyle:{"margin-top":"20px"}},[i("div",{staticClass:"item_name"},[e._v("项目名：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.projectName,expression:"projectName"}],ref:"pName",staticClass:"item_text",attrs:{readonly:"detail"==e.operate,placeholder:"请输入项目名称"},domProps:{value:e.projectName},on:{input:function(t){t.target.composing||(e.projectName=t.target.value)}}})]),"add"==e.operate?i("label",{staticClass:"flexlayout input-item"},[i("div",{staticClass:"item_name"},[e._v("项目类型：")]),e._l(e.projectTypes,(function(t,s){return i("label",{key:s,staticClass:"radio-item"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.projectType,expression:"projectType"}],attrs:{readonly:"detail"==e.operate,type:"radio",name:"version"},domProps:{value:t.value,checked:e._q(e.projectType,t.value)},on:{change:function(s){e.projectType=t.value}}}),e._v(" \n            "),e._v(e._s(t.name)+"\n          ")])}))],2):e._e(),e.projectType>0?i("label",{staticClass:"flexlayout input-item"},[i("div",{staticClass:"item_name"},[e._v(e._s(1==e.projectType?"服务端口":"访问地址")+"：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.projectTypeValue,expression:"projectTypeValue"}],staticClass:"item_text",attrs:{readonly:"detail"==e.operate,placeholder:1==e.projectType?"请输入服务端口，请用;隔开":"请输入访问地址，请用;隔开"},domProps:{value:e.projectTypeValue},on:{input:function(t){t.target.composing||(e.projectTypeValue=t.target.value)}}}),1==e.projectType&&"detail"!=e.operate?i("button",{staticClass:"recommend btn",on:{click:e.getRecommend}},[e._v("推荐端口")]):e._e()]):e._e(),i("label",{staticClass:"flexlayout input-item"},[i("div",{staticClass:"item_name"},[e._v("项目描述：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.projectDesc,expression:"projectDesc"}],staticClass:"item_text",attrs:{readonly:"detail"==e.operate,placeholder:"请输入项目描述"},domProps:{value:e.projectDesc},on:{input:function(t){t.target.composing||(e.projectDesc=t.target.value)}}})]),i("label",{staticClass:"flexlayout input-item"},[i("div",{staticClass:"item_name"},[e._v("规则说明：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.projectDesc,expression:"projectDesc"}],staticClass:"item_text",attrs:{readonly:"detail"==e.operate,placeholder:"请输入项目描述"},domProps:{value:e.projectDesc},on:{input:function(t){t.target.composing||(e.projectDesc=t.target.value)}}})]),i("div",{class:["input-item","flexlayout",0!=e.groupList.length||"input-box-bottom"]},[i("div",{staticClass:"input-box-title"},[e._v("运维组：")]),i("MoreSelect",{attrs:{disabled:"detail"==e.operate,items:e.groupitems,selectname:e.selectGroupNames},on:{select:e.selectdGroupName},model:{value:e.groupids,callback:function(t){e.groupids=t},expression:"groupids"}})],1),0!=e.groupList.length?i("div",{staticClass:"right_box"},[i("div",{staticClass:"name_box"},e._l(e.groupList,(function(t,s){return i("div",{key:s,staticClass:"edit_right",on:{click:function(i){return e.handleRights(t,s)}}},[i("span",[e._v(e._s(t.name))])])})),0),i("div",{staticClass:"choose_right"},[i("p",{staticClass:"right_title"},[e._v(e._s(e.groupList[e.currentIndex].name)+"的权限")]),i("div",{staticClass:"rights"},[i("label",{staticClass:"right",attrs:{title:"日志、dump堆栈、操作记录"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.groupList[e.currentIndex].rights[0],expression:"groupList[currentIndex].rights[0]"}],attrs:{type:"radio",disabled:"detail"==e.operate,name:"read",value:"READ"},domProps:{checked:e._q(e.groupList[e.currentIndex].rights[0],"READ")},on:{change:function(t){return e.$set(e.groupList[e.currentIndex].rights,0,"READ")}}}),i("div",[e._v(" 仅可见")])]),i("label",{staticClass:"right",attrs:{title:"“仅可见”基础上，增加重启、启动、停止权限"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.groupList[e.currentIndex].rights[0],expression:"groupList[currentIndex].rights[0]"}],attrs:{type:"radio",disabled:"detail"==e.operate,name:"operator",value:"OPERATOR"},domProps:{checked:e._q(e.groupList[e.currentIndex].rights[0],"OPERATOR")},on:{change:function(t){return e.$set(e.groupList[e.currentIndex].rights,0,"OPERATOR")}}}),i("div",[e._v(" 基础操作")])]),i("label",{staticClass:"right",attrs:{title:"所有管理操作权限"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.groupList[e.currentIndex].rights[0],expression:"groupList[currentIndex].rights[0]"}],attrs:{type:"radio",disabled:"detail"==e.operate,name:"update",value:"UPDATE"},domProps:{checked:e._q(e.groupList[e.currentIndex].rights[0],"UPDATE")},on:{change:function(t){return e.$set(e.groupList[e.currentIndex].rights,0,"UPDATE")}}}),i("div",[e._v(" 管理操作")])])])])]):e._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:"update"==e.operate,expression:"operate == 'update'"}],staticClass:"input-item flexlayout input-box-bottom"},[i("div",{staticClass:"input-box-title"},[e._v("所有者：")]),i("SingleSelect",{attrs:{selectname:e.owner.name,neednet:!0,items:e.userList},on:{serachbykeyword:e.getUserList},model:{value:e.owner.id,callback:function(t){e.$set(e.owner,"id",t)},expression:"owner.id"}})],1),i("div",{staticClass:"input-box",staticStyle:{"margin-top":"0"}},[i("label",[e._v("项目映射")])]),i("table",{directives:[{name:"show",rawName:"v-show",value:e.editObj.binds&&e.editObj.binds.length>0,expression:"editObj.binds && editObj.binds.length > 0"}],staticClass:"table tableDatil"},[i("thead",[i("th",[e._v("源目录")]),i("th",[e._v("挂载目录")]),"detail"!=e.operate?i("th",{attrs:{width:"30px"}},[e._v("删除")]):e._e()]),i("tbody",e._l(e.editObj.binds,(function(t,r){return i("tr",{key:r,ref:"bindstr",refInFor:!0},[i("td",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.source,expression:"item.source"}],ref:"bindsource",refInFor:!0,staticClass:"paramtext",staticStyle:{width:"200px"},attrs:{readonly:"detail"==e.operate},domProps:{value:t.source},on:{input:function(s){s.target.composing||e.$set(t,"source",s.target.value)}}})]),i("td",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.target,expression:"item.target"}],ref:"bindtarget",refInFor:!0,staticClass:"paramtext",attrs:{readonly:"detail"==e.operate},domProps:{value:t.target},on:{input:function(s){s.target.composing||e.$set(t,"target",s.target.value)}}})]),"detail"!=e.operate?i("td",{staticClass:"table-handle",on:{click:function(t){return e.removebinds(r)}}},[i("img",{staticClass:"removeparam",attrs:{src:s("5732")}})]):e._e()])})),0)]),"detail"!=e.operate?i("div",{staticClass:"addrowBar",on:{click:function(t){return e.addRowCount("bind")}}},[e._v("+")]):e._e(),i("div",{staticClass:"input-box"},[i("label",[e._v("环境变量")])]),i("table",{directives:[{name:"show",rawName:"v-show",value:e.editObj.envs&&e.editObj.envs.length>0,expression:"editObj.envs && editObj.envs.length > 0"}],staticClass:"table tableDatil"},[i("thead",[i("th",[e._v("属性名")]),i("th",[e._v("属性值")]),"detail"!=e.operate?i("th",{attrs:{width:"30px"}},[e._v("删除")]):e._e()]),i("tbody",e._l(e.editObj.envs,(function(t,r){return i("tr",{key:r,ref:"envstr",refInFor:!0},[i("td",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.key,expression:"item.key"}],ref:"envsKey",refInFor:!0,staticClass:"paramtext",staticStyle:{width:"200px"},attrs:{readonly:"detail"==e.operate},domProps:{value:t.key},on:{input:function(s){s.target.composing||e.$set(t,"key",s.target.value)}}})]),i("td",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"item.value"}],ref:"envsValue",refInFor:!0,staticClass:"paramtext",attrs:{readonly:"detail"==e.operate},domProps:{value:t.value},on:{input:function(s){s.target.composing||e.$set(t,"value",s.target.value)}}})]),"detail"!=e.operate?i("td",{staticClass:"table-handle",on:{click:function(t){return e.removeenvs(r)}}},[i("img",{staticClass:"removeparam",attrs:{src:s("5732")}})]):e._e()])})),0)]),"detail"!=e.operate?i("div",{staticClass:"addrowBar",on:{click:function(t){return e.addRowCount("envs")}}},[e._v("+")]):e._e(),i("div",{staticClass:"input-box"},[i("label",[e._v("项目映射示例")])]),i("table",{staticClass:"table tableDatil"},[i("thead",[i("th",[e._v("属性名")]),i("th",[e._v("属性示例值")]),i("th",[e._v("说明")])]),i("tbody",[i("tr",[i("td",[e._v("/wf/html/")]),i("td",[e._v("/home/boot/html/")]),i("td",[e._v("将宿主机的/wf/html目录挂载到项目的/home/boot/html/目录")])])])]),i("div",{staticClass:"input-box"},[i("label",[e._v("环境变量示例")])]),i("table",{staticClass:"table tableDatil"},[i("thead",[i("th",[e._v("属性名")]),i("th",[e._v("属性示例值")]),i("th",[e._v("说明")])]),i("tbody",[i("tr",[i("td",[e._v("Xms")]),i("td",[e._v("128m")]),i("td",[e._v("指定jvm启动时分配的内存")])]),i("tr",[i("td",[e._v("Xmx")]),i("td",[e._v("256m")]),i("td",[e._v("指定jvm运行过程中分配的最大内存")])]),i("tr",[i("td",[e._v("Xss")]),i("td",[e._v("256k")]),i("td",[e._v("指定jvm启动的每个线程分配的内存大小")])]),i("tr",[i("td",[e._v("maxDirectMemorySize")]),i("td",[e._v("64m")]),i("td",[e._v("指定jvm的DirectMemory最大值")])]),i("tr",[i("td",[e._v("disabelG1GC")]),i("td",[e._v("false")]),i("td",[e._v("是否禁用G1GC,true为禁用,false为不禁用")])]),i("tr",[i("td",[e._v("RLOG_URL")]),i("td",[e._v("http://127.0.0.1:1200/log.j")]),i("td",[e._v("远程日志的链接")])]),i("tr",[i("td",[e._v("WEFORWARD_HOSTS")]),i("td",[e._v("//weforawrd.wf")]),i("td",[e._v("Weforward主机域名")])]),i("tr",[i("td",[e._v("WF_JAVA_OPTIONS")]),i("td"),i("td",[e._v("自定义的java程序启动参数")])])])]),"detail"!=e.operate?i("div",{staticClass:"btn-box"},[i("button",{staticClass:"add-btn",on:{click:e.addProject}},["add"==e.operate?i("span",[e._v("添加")]):e._e(),"update"==e.operate?i("span",[e._v("修改")]):e._e()])]):e._e(),e.editObj.can_delete&&"update"==e.operate?i("div",{staticClass:"delete-btn"},[i("div",{staticClass:"query_button",on:{click:e.clickDelete}},[e._v("\n            删 除 项 目\n          ")])]):e._e()])]),i("ReminderModel",{attrs:{isshow:e.showModal,handelName:"删除",isDelete:!0,deleteName:e.projectName},on:{sure:e.deleteProject,toggle:function(t){e.showModal=!1}}})],1)},r=[];s("ac4d"),s("8a81"),s("5df3"),s("1c4c"),s("c5f6"),s("6b54"),s("a481"),s("28a5"),s("7f7f"),s("ac6a");function a(e,t){var s="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=o(e))||t&&e&&"number"===typeof e.length){s&&(e=s);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,n=!0,l=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return n=e.done,e},e:function(e){l=!0,a=e},f:function(){try{n||null==s.return||s.return()}finally{if(l)throw a}}}}function o(e,t){if(e){if("string"===typeof e)return n(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}var l={name:"AddProject",props:{isshow:{type:Boolean,default:!1},obj:{type:Object,default:function(){return{}}}},components:{WoolShowmodal:function(){return s.e("chunk-41c82f40").then(s.bind(null,"59c5"))},MoreSelect:function(){return s.e("chunk-67c0ae74").then(s.bind(null,"b310"))},SingleSelect:function(){return s.e("chunk-9a84efc2").then(s.bind(null,"4e15"))},ReminderModel:function(){return s.e("chunk-1b976ab2").then(s.bind(null,"2578"))}},data:function(){return{projectName:"",msgView:null,projectDesc:"",operate:"add",pId:"",projectTypes:[{name:"JAVA",value:1,icon:"../img/java.png"},{name:"HTML",value:2,icon:"../img/html.png"}],projectType:0,projectTypeValue:"",owner:{},groupitems:[],userList:[],groupids:"",selectGroupNames:"",editObj:{},groupList:[],currentIndex:0,showModal:!1}},methods:{removebinds:function(e){this.editObj.binds.splice(e,1),this.$forceUpdate()},removeenvs:function(e){this.editObj.envs.splice(e,1),this.$forceUpdate()},getRecommend:function(){var e=this,t="?method=/devops/home/recommendedServerPort";this.$wf.post(t).then((function(t){e.projectTypeValue=t})).catch((function(t){e.$wool.showwarn("获取推荐端口失败")}))},addRowCount:function(e){if("envs"==e){this.editObj.envs||(this.editObj.envs=[]);var t={key:"",value:""};this.editObj.envs.push(t)}if("bind"==e){this.editObj.binds||(this.editObj.binds=[]);var s={source:"",target:""};this.editObj.binds.push(s)}this.$forceUpdate()},addProject:function(){var e=this;if(""==this.projectName)return this.$refs.pName.focus(),void this.$wool.showwarn("请输入项目名");var t=[],s=[];this.editObj.envs||(this.editObj.envs=[]),this.editObj.binds||(this.editObj.binds=[]),this.editObj.envs.forEach((function(e){if(!e.key||!e.value)return!1;t.push(e.key+"="+e.value)})),this.editObj.binds.forEach((function(e){if(!e.source||!e.target)return!1;s.push(e.source+":"+e.target)}));for(var i=0;i<this.groupList.length;i++)if(0==this.groupList[i].rights.length)return void this.$wool.showwarn(this.groupList[i].name+"的权限不能为空！");var r={id:this.pId,op:this.operate,name:this.projectName,envs:t,binds:s,desc:this.projectDesc,groups:this.groupids.split(";").filter((function(e){return e})),type:this.projectType,group_list:this.groupList.filter((function(e){return{id:e.id,rights:e.rights}}))},a=(this.projectTypeValue.toString()||"").replace(/,|，|；/g,";"),o=a.split(";").filter((function(e){return e}));1==this.projectType&&(r["serverPorts"]=o,r.serverPorts.forEach((function(e,t){r.serverPorts[t]=Number(e)}))),2==this.projectType&&(r["accessUrls"]=o),"update"==this.operate&&(r["owner"]=this.owner.id),this.msgView=this.$wool.showloading("正在保存");var n="?method=/devops/home/project";this.$wf.post(n,r).then((function(t){return e.requestSuc(t)})).catch((function(t){e.msgView.msgwarn(t.message).hide()}))},requestSuc:function(e){var t="保存成功";e.id?(this.$emit("toggle"),this.$emit("load")):t="保存失败",this.msgView.msgsucc(t).hide()},clearAll:function(){this.owner={},this.projectName="",this.projectDesc="",this.operate="add",this.selectGroupNames="",this.groupids="",this.projectType=0,this.projectTypeValue="",this.pId="",this.editObj={},this.groupList=[],this.currentIndex=0},getGroupList:function(){var e=this;this.$wf.post("?method=/devops/home/groups",{page:1,page_size:512,keywords:""}).then((function(t){e.groupitems=t.items})).catch((function(t){return e.$wool.showwarn("获取群组列表失败"+t.message)}))},getUserList:function(e){var t=this,s={k:e,p:1,pagesize:50},i="?method=/devops/home/users";this.$wf.post(i,s).then((function(e){t.userList=e.items||[],t.$forceUpdate()})).catch((function(e){return t.$wool.showwarn(e.message)}))},setEditValue:function(e){var t=this;if(this.$nextTick((function(){e.groups.forEach((function(e){t.groupids=t.groupids+e.id+";",t.selectGroupNames=t.selectGroupNames+e.name+";",t.groupList.push({id:e.id,name:e.name,rights:e.rights})}))})),this.projectName=e.name,this.projectDesc=e.desc,this.projectType=e.type,e.server_ports&&e.server_ports.length>0){var s,i=a(e.server_ports);try{for(i.s();!(s=i.n()).done;){var r=s.value;this.projectTypeValue=this.projectTypeValue+r+";"}}catch(d){i.e(d)}finally{i.f()}}if(e.access_urls&&e.access_urls.length>0){var o,n=a(e.access_urls);try{for(n.s();!(o=n.n()).done;){var l=o.value;this.projectTypeValue=this.projectTypeValue+l+";"}}catch(d){n.e(d)}finally{n.f()}}this.owner=e.owner,0!=this.groupList.length&&this.handleRights(this.groupList[0],0)},selectdGroupName:function(e,t){var s=t.split(";");s.pop();var i=e.split(";");i.pop();for(var r=[],a=0;a<i.length;a++)r.push({name:s[a],id:i[a],rights:[]});var o=this;this.groupList=r.map((function(e){return o.groupList.map((function(t){e.id==t.id&&(e.rights=t.rights)})),e})),s=[],i=[],this.currentIndex=0},handleRights:function(e,t){this.currentIndex=t},deleteProject:function(){var e=this;this.showModal=!1;var t=this.$wool.showloading("正在删除"),s={id:this.pId,op:"delete"};this.$wf.post("devops?method=/devops/home/project",s).then((function(s){e.$emit("toggle"),e.$emit("load"),t.msgwarn("删除成功！").hide()})).catch((function(e){t.msgwarn(e.message).hide()}))},clickDelete:function(){this.showModal=!0}},watch:{isshow:function(e){e&&(this.clearAll(),"{}"!=JSON.stringify(this.obj)&&(this.editObj=this.obj,this.operate="update",this.pId=this.editObj.id,this.editObj.notEdit&&(this.operate="detail"),this.setEditValue(this.editObj),this.getUserList(this.owner.name)))}},mounted:function(){this.getGroupList()}},d=l,c=(s("51f3"),s("2877")),u=Object(c["a"])(d,i,r,!1,null,"a95b723c",null);t["default"]=u.exports}}]);