(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-498d640e"],{"16d7":function(t,e,s){},"83fa":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"project_area"},[a("div",{staticClass:"query"},[a("div",{staticClass:"query_input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.page.keywords,expression:"page.keywords"}],attrs:{type:"text"},domProps:{value:t.page.keywords},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchByKeyword(e)},input:function(e){e.target.composing||t.$set(t.page,"keywords",e.target.value)}}}),a("div",{staticClass:"query_button",on:{click:t.searchByKeyword}},[t._v("\n        查询\n      ")])]),a("div",{staticClass:"query_group"},[a("div",{staticClass:"query_select"},[t._v("\n        运维组："),a("SingleSelect",{attrs:{items:t.groupName},on:{select:t.selectByGroup}})],1),a("div",{staticClass:"add_button",on:{click:t.addMachine}},[t._v("\n        +添加\n      ")])])]),a("table",{staticClass:"project_table"},[t._m(0),t.noData?t._e():a("tbody",t._l(t.machineList,(function(e,n){return a("tr",{key:n},[a("td",{staticClass:"rongqi_td"},[a("img",{attrs:{src:s("8981")}}),e.name?a("span",{staticClass:"rongqiName",attrs:{title:e.name}},[t._v(t._s(e.name))]):a("span",{staticClass:"rongqiName"},[t._v("--")]),a("br"),t._l(e.groups,(function(s,n){return 0!=e.groups.length?a("span",{key:n,staticClass:"yunweizu",attrs:{title:s.name}},[t._v("\n        "+t._s(s.name)+"\n        "),a("br")]):t._e()})),0==e.groups.length?a("span",{staticClass:"yunweizu"},[t._v("--")]):t._e()],2),a("td",{staticStyle:{"font-size":"12px","line-height":"18px"}},[e.showloading?a("span",[a("Loading",{attrs:{isshow:e.showloading}})],1):a("span",[a("span",[t._v("系统负载（"+t._s(e.cpuNum||"--")+"核CPU）："+t._s(e.agentLoadAverage||"--")+"%"),a("br")]),a("span",[t._v("内存情况：已用"+t._s(e.agentMemoryUsed||"--")+"，总内存"+t._s(e.agentMemoryTotal||"--")),a("br")]),a("span",[t._v("磁盘空间：已用"+t._s(e.agentDistUsed||"--")+"，总空间"+t._s(e.agentDistTotal||"--")),a("br")]),a("span",[t._v("持续时间："+t._s(e.loadtime||"--")),a("br")]),a("span",[t._v("启动时间："+t._s(e.starttime?e.starttime.format("yyyy-MM-dd hh:mm:ss"):"--")),a("br")]),0!=e.props.length?a("span",[t._v(t._s(e.props[0].key)+":"+t._s(e.props[0].value))]):a("span",[t._v("--")])])]),a("td",{staticClass:"statphoto"},[a("div",{staticClass:"echarts_tb"},[e.showloading?a("span",[a("Loading",{attrs:{isshow:e.showloading}})],1):a("div",[a("div",{staticClass:"echarts1",class:e.noload?"":"echarts_wh"}),e.noload?a("div",[t._v("--")]):t._e()])])]),a("td",{staticClass:"statphoto"},[a("div",{staticClass:"echarts_tb"},[e.showloading?a("span",[a("Loading",{attrs:{isshow:e.showloading}})],1):a("div",[a("div",{staticClass:"echarts2",class:e.nomeomory?"":"echarts_wh"}),e.nomeomory?a("div",[t._v("--")]):t._e()])])]),a("td",{staticClass:"statphoto"},[a("div",{staticClass:"echarts_tb"},[e.showloading?a("span",[a("Loading",{attrs:{isshow:e.showloading}})],1):a("div",[a("div",{staticClass:"echarts3",class:e.nodist?"":"echarts_wh"}),e.nodist?a("div",[t._v("--")]):t._e()])])]),a("td",{staticClass:"caozuo_td"},[e.can_edit?a("span",{staticStyle:{"margin-right":"10px"},on:{click:function(s){return t.editMachine(e)}}},[t._v("编辑")]):t._e()])])})),0),t.noData?a("tr",{staticClass:"noData"},[a("td",{attrs:{colspan:"7"}},[t._v("暂无数据")])]):t._e()]),a("AddMachine",{ref:"addmodel",attrs:{obj:t.editMachineObj,isshow:t.showCreate},on:{toggle:function(e){t.showCreate=!t.showCreate},load:t.getMachineList}}),t.noData?t._e():a("PagerBar",{staticStyle:{"margin-bottom":"2%"},attrs:{page:t.page},on:{change:t.searchByPage}})],1)},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",{staticClass:"project_title"},[s("td",{staticStyle:{width:"10%"}},[t._v("容器/运维组")]),s("td",{staticStyle:{width:"84%","text-align":"center"},attrs:{colspan:"4"}},[t._v("所在服务器情况")]),s("td",{staticStyle:{width:"6%"}},[t._v("操作")])])}];s("8e6e"),s("ac6a"),s("456d"),s("a481");function i(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}s("6b54"),s("7f7f"),s("96cf");var o=s("1da1");function r(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function c(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?r(Object(s),!0).forEach((function(e){i(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var h=s("3eba");s("ef97"),s("007d"),s("627c");var d={components:{Loading:function(){return s.e("chunk-297eb316").then(s.bind(null,"cea9"))},PagerBar:function(){return s.e("chunk-22e86add").then(s.bind(null,"2f3e"))},SingleSelect:function(){return s.e("chunk-90e745ba").then(s.bind(null,"4e15"))},AddMachine:function(){return s.e("chunk-427d9fa8").then(s.bind(null,"ff52"))}},data:function(){return{page:{current:1,pagecount:1,totalCount:0,pagesize:6,keywords:""},noData:!1,machineList:[],groupName:[],groupid:"",editMachineObj:{},showCreate:!1}},methods:{getMachineList:function(){var t=this,e=this.$wool.showloading("正在加载..."),s={page:this.page.current,page_size:this.page.pagesize,keywords:this.page.keywords,groupid:this.groupid};this.$wf.post("devops?method=/devops/home/machines",s).then((function(s){e.hide(0),console.log(s),0==s.items.length?t.noData=!0:(t.noData=!1,t.page.current=s.page,t.page.pagecount=s.page_count,t.page.totalCount=s.count,t.machineList=s.items,t.editData())})).catch((function(s){e.hide(0),t.$wool.showwarn(s)}))},editData:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,s,a,n,i,o,r,h,d,p,l,m,u,g,v,f,w,y,_,b,L;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(e=0;e<this.machineList.length;e++)this.machineList[e].showloading=!0;s=0;case 2:if(!(s<this.machineList.length)){t.next=77;break}if(!this.machineList[s].name){t.next=70;break}return this.machineList[s].showloading=!1,a=this.machineList[s].name,t.next=8,this.$wf.post("devops?method=/devops/metrics/agentLoadAverage",{name:a});case 8:return n=t.sent,this.machineList[s].agentLoadAverage=n,t.next=12,this.$wf.post("devops?method=/devops/metrics/agent_cpu_num",{name:a});case 12:return i=t.sent,this.machineList[s].cpuNum=i,t.next=16,this.$wf.post("devops?method=/devops/metrics/agentMemoryUsed",{name:a});case 16:return o=t.sent,this.machineList[s].agentMemoryUsed=o,t.next=20,this.$wf.post("devops?method=/devops/metrics/agentMemoryTotal",{name:a});case 20:return r=t.sent,this.machineList[s].agentMemoryTotal=r,t.next=24,this.$wf.post("devops?method=/devops/metrics/agent_path_tags");case 24:return h=t.sent,h=h.toString(),t.next=28,this.$wf.post("devops?method=/devops/metrics/agentDistUsed",{name:a,path:h});case 28:return d=t.sent,this.machineList[s].agentDistUsed=d,t.next=32,this.$wf.post("devops?method=/devops/metrics/agentDistTotal",{name:a,path:h});case 32:return p=t.sent,this.machineList[s].agentDistTotal=p,t.next=36,this.$wf.post("devops?method=/devops/metrics/agentUpTime",{name:a});case 36:return l=t.sent,this.machineList[s].loadtime=l,t.next=40,this.$wf.post("devops?method=/devops/metrics/agentStartTime",{name:a});case 40:return m=t.sent,this.machineList[s].starttime=m,u=new Date(Date.now()-18e4),g=new Date(u.getTime()-432e5),v={end:u,begin:g,name:a,interval:15},t.next=47,this.$wf.post("devops?method=/devops/metrics/agentLoadAverageRange",v);case 47:return f=t.sent,t.next=50,this.$wf.post("devops?method=/devops/metrics/agentLoadAverageMaxRange",v);case 50:return w=t.sent,f?(this.machineList[s].showloading=!1,this.drawCharts(f,w,"load",s)):this.machineList[s].noload=!0,t.next=54,this.$wf.post("devops?method=/devops/metrics/agentMemoryUsedRange",v);case 54:return y=t.sent,t.next=57,this.$wf.post("devops?method=/devops/metrics/agentMemoryTotalRange",v);case 57:return _=t.sent,y?(this.machineList[s].showloading=!1,this.drawCharts(y,_,"memory",s)):this.machineList[s].nomeomory=!0,t.next=61,this.$wf.post("devops?method=/devops/metrics/agentDistUsedRange",c(c({},v),{},{path:h}));case 61:return b=t.sent,t.next=64,this.$wf.post("devops?method=/devops/metrics/agentDistTotalRange",c(c({},v),{},{path:h}));case 64:L=t.sent,b?(this.machineList[s].showloading=!1,this.drawCharts(b,L,"dist",s)):this.machineList[s].nodist=!0,this.machineList[s].showloading=!1,this.$forceUpdate(),t.next=74;break;case 70:this.machineList[s].showloading=!1,this.machineList[s].noload=!0,this.machineList[s].nomeomory=!0,this.machineList[s].nodist=!0;case 74:s++,t.next=2;break;case 77:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),drawCharts:function(t,e,s,a){if("load"==s){this.machineList[a].noload=!1,this.$forceUpdate();var n=h.init(document.getElementsByClassName("echarts1")[a])}else if("memory"==s){this.machineList[a].nomeomory=!1,this.$forceUpdate();n=h.init(document.getElementsByClassName("echarts2")[a])}else if("dist"==s){this.machineList[a].nodist=!1,this.$forceUpdate();n=h.init(document.getElementsByClassName("echarts3")[a])}var i=t.map((function(t){var e=t.time.getHours();e=e<10?"0"+e:e;var s=t.time.getMinutes();return s=s<10?"0"+s:s,e+":"+s})),o=t.map((function(t){return t.format_value.replace("G","")})),r=e.map((function(t){return t.format_value.replace("G","")})),c={grid:{x:35,y:25,x2:25,y2:50},title:{text:"",x:"center",textStyle:{fontSize:12}},tooltip:{trigger:"axis"},xAxis:{type:"category",boundaryGap:!1,data:i,splitNumber:1},yAxis:{type:"value",axisLabel:{formatter:"{value}G",show:!0,textStyle:{fontSize:10}}},series:[{data:o,type:"line",areaStyle:{},itemStyle:{normal:{borderColor:"#3398DB"}},lineCategoryGap:"0%"},{data:r,type:"line",areaStyle:{},itemStyle:{normal:{borderColor:"#3398DB"}},lineCategoryGap:"0%"}],color:["#E062AE","#3398DB"]};"load"==s?(c.title.text="系统负载",c.yAxis.axisLabel.formatter="{value}%",c.series[0].name="系统负载",c.series[1].name="最高系统负载"):"memory"==s?(c.title.text="已用内存",c.series[0].name="可用内存",c.series[1].name="总内存"):"dist"==s&&(c.title.text="磁盘已用空间",c.series[0].name="已用空间",c.series[1].name="总空间"),n.setOption(c)},searchByPage:function(t){this.page.current=t.page,this.machineList=[],this.getMachineList()},searchByKeyword:function(){this.page.current=1,this.getMachineList()},getGroupList:function(){var t=this;this.$wf.post("devops?method=/devops/home/groups").then((function(e){t.groupName=e.items}))},selectByGroup:function(t){this.groupid=t,this.getMachineList()},addMachine:function(){this.editMachineObj={},this.showCreate=!this.showCreate},editMachine:function(t){this.editMachineObj=t,this.showCreate=!this.showCreate}},mounted:function(){this.getMachineList(),this.getGroupList()}},p=d,l=(s("dadf"),s("2877")),m=Object(l["a"])(p,a,n,!1,null,"b6618796",null);e["default"]=m.exports},8981:function(t,e,s){t.exports=s.p+"img/rongqi_sel.cca7b653.png"},"8e6e":function(t,e,s){var a=s("5ca1"),n=s("990b"),i=s("6821"),o=s("11e9"),r=s("f1ae");a(a.S,"Object",{getOwnPropertyDescriptors:function(t){var e,s,a=i(t),c=o.f,h=n(a),d={},p=0;while(h.length>p)s=c(a,e=h[p++]),void 0!==s&&r(d,e,s);return d}})},"990b":function(t,e,s){var a=s("9093"),n=s("2621"),i=s("cb7c"),o=s("7726").Reflect;t.exports=o&&o.ownKeys||function(t){var e=a.f(i(t)),s=n.f;return s?e.concat(s(t)):e}},dadf:function(t,e,s){"use strict";s("16d7")}}]);