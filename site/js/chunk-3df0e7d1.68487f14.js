(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3df0e7d1"],{1774:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wangguan_area"},[s("div",{staticClass:"selbox"},[e._v("\n    服务名："),s("SingleSelect",{attrs:{width:150,items:e.serviceNameList,selectname:e.serviceName},on:{select:e.changeName}}),s("span",{staticStyle:{"margin-left":"3%"}},[e._v("服务编号："),s("SingleSelect",{attrs:{width:150,items:e.serviceNoList,selectname:e.serviceNo},on:{select:e.changeNo}})],1),s("span",{staticStyle:{"margin-left":"3%"}},[s("WoolPCDateTimePicker",{staticClass:"time_sel",attrs:{format:"yyyy-MM-dd HH:mm",autopickdate:!1},model:{value:e.kaishiTime,callback:function(t){e.kaishiTime=t},expression:"kaishiTime"}}),e._v(" 至\n      "),s("WoolPCDateTimePicker",{staticClass:"time_sel",attrs:{format:"yyyy-MM-dd HH:mm",autopickdate:!1},model:{value:e.jieshuTime,callback:function(t){e.jieshuTime=t},expression:"jieshuTime"}}),s("div",{staticClass:"query_button",staticStyle:{"margin-left":"1%"},on:{click:e.freshEcharts}},[e._v("查询")]),s("div",{staticClass:"query_button",on:{click:e.freshEcharts}},[e._v("刷新")])],1)],1),s("div",{staticClass:"facts_boxs"},[s("div",{class:["query_button",{is_sel:!e.isOnTime}],staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.clickTime("onTime")}}},[e._v("实时")]),s("div",{class:["query_button",{is_sel:!e.isRecentHour}],staticStyle:{"padding-left":"10px","padding-right":"10px"},on:{click:function(t){return e.clickTime("recentHour")}}},[e._v("近24小时")]),s("div",{class:["query_button",{is_sel:!e.isRecentDay}],on:{click:function(t){return e.clickTime("recentDay")}}},[e._v("近7天")]),s("div",{staticClass:"item",staticStyle:{width:"180px"}},[s("span",[e._v("启动时间")]),s("br"),s("span",[e._v(e._s(e.startTime||"--"))])]),s("div",{staticClass:"item",staticStyle:{width:"180px"}},[s("span",[e._v("持续时间")]),s("br"),s("span",[e._v(e._s(e.loadTime||"--"))])]),s("div",{staticClass:"item"},[s("span",[e._v("内存上限")]),s("br"),s("span",[e._v(e._s(e.neicunMax||"--"))])]),s("div",{staticClass:"item"},[s("span",[e._v("已用内存")]),s("br"),s("span",[e._v(e._s(e.usedNeicun||"--"))])]),s("div",{staticClass:"item"},[s("span",[e._v("已分配内存")]),s("br"),s("span",[e._v(e._s(e.fenpeiNeicun||"--"))])])]),e._m(0),s("div",{staticClass:"JVM_box",staticStyle:{width:"98%","background-color":"#fff","border-radius":"5px",border:"#e3ebf6 1px solid"}}),e._m(1),e._m(2),e._m(3),e._m(4)])},n=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"item_title",staticStyle:{"margin-bottom":"5px","margin-top":"10px"}},[s("span",[e._v("内存")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"item_title"},[s("span",[e._v("JVM Misc")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"JVM_box"},[s("div",{attrs:{id:"cpu_box"}}),s("div",{attrs:{id:"thread_box"}}),s("div",{attrs:{id:"GC_box"}})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"item_title"},[s("span",[e._v("Weforward RPC")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"JVM_box",staticStyle:{height:"550px"}},[s("div",{attrs:{id:"RPC_pl"}}),s("div",{attrs:{id:"RPC_error_num"}}),s("div",{attrs:{id:"spend_time"}}),s("div",{attrs:{id:"spendtime_max"}}),s("div",{attrs:{id:"RPC_num"}})])}],r=(s("96cf"),s("1da1")),a=s("2909"),o=(s("ac6a"),s("313e")),c={components:{SingleSelect:function(){return s.e("chunk-90e745ba").then(s.bind(null,"4e15"))},WoolPCDateTimePicker:function(){return s.e("chunk-2fac596e").then(s.bind(null,"2d87"))}},data:function(){return{serviceNameList:[],serviceName:"",serviceNoList:[],serviceNo:"",startTime:"",loadTime:"",neicunMax:"",usedNeicun:"",fenpeiNeicun:"",timerList:[],kaishiTime:"",jieshuTime:"",queryKsTime:"",queryJsTime:"",isOnTime:!1,isRecentHour:!1,isRecentDay:!1}},watch:{},methods:{freshEcharts:function(){this.serviceName||this.serviceNo?(this.kaishiTime||this.jieshuTime)&&(this.isOnTime=!1,this.isRecentHour=!1,this.isRecentDay=!1,new Date(this.kaishiTime)>=new Date(this.jieshuTime)?this.$wool.showwarn("时间选择错误！"):new Date(this.jieshuTime)-new Date(this.kaishiTime)<=6e4?this.$wool.showwarn("时间间隔必须大于1分钟"):(this.queryKsTime=new Date(this.kaishiTime),this.queryJsTime=new Date(this.jieshuTime),this.drawEcharts())):this.$wool.showwarn("请选择服务编号和服务名！")},clickTime:function(e){this.serviceName&&this.serviceNo&&(this.kaishiTime="",this.jieshuTime="",this.queryJsTime=new Date,"onTime"==e?(this.isOnTime=!0,this.isRecentHour=!1,this.isRecentDay=!1,this.queryKsTime=new Date(this.queryJsTime.getTime()-18e5)):"recentHour"==e?(this.isOnTime=!1,this.isRecentHour=!0,this.isRecentDay=!1,this.queryKsTime=new Date(this.queryJsTime.getTime()-864e5),this.kaishiTime=this.queryKsTime.Format("y-M-d h:m"),this.jieshuTime=this.queryJsTime.Format("y-M-d h:m")):"recentDay"==e&&(this.isOnTime=!1,this.isRecentHour=!1,this.isRecentDay=!0,this.queryKsTime=new Date(this.queryJsTime.getTime()-6048e5),this.kaishiTime=this.queryKsTime.Format("y-M-d h:m"),this.jieshuTime=this.queryJsTime.Format("y-M-d h:m")),this.drawEcharts())},changeName:function(e){var t=this;this.serviceName=e,this.serviceNoList=[],this.$wf.post("devops?method=/devops/gateway/service_details",{name:e}).then((function(e){e.forEach((function(e){t.serviceNoList=[].concat(Object(a["a"])(t.serviceNoList),[{name:e.no,id:e.no}]),t.changeNo(t.serviceNoList[0].id)}))}))},changeNo:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var s,i,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.serviceNo=t,s={name:this.serviceName,no:this.serviceNo},i=this.$wool.showloading("加载中......"),e.prev=3,e.next=6,this.$wf.post("devops?method=/devops/metrics/ms_start_time",s);case 6:return n=e.sent,n&&(r=new Date(n),this.startTime=r.Format()),e.next=10,this.$wf.post("devops?method=/devops/metrics/ms_up_time",s);case 10:return this.loadTime=e.sent,e.next=13,this.$wf.post("devops?method=/devops/metrics/ms_memory_max",s);case 13:return this.neicunMax=e.sent,e.next=16,this.$wf.post("devops?method=/devops/metrics/ms_memory_used",s);case 16:return this.usedNeicun=e.sent,e.next=19,this.$wf.post("devops?method=/devops/metrics/ms_memory_alloc",s);case 19:this.fenpeiNeicun=e.sent,i.hide(0),e.next=27;break;case 23:e.prev=23,e.t0=e["catch"](3),i.hide(0),this.$wool.showwarn(e.t0);case 27:this.isOnTime=!0,this.isRecentHour=!1,this.isRecentDay=!1,this.drawEcharts();case 31:case"end":return e.stop()}}),e,this,[[3,23]])})));function t(t){return e.apply(this,arguments)}return t}(),getServiceList:function(){var e=this,t=this.$wool.showloading("加载中...");this.$wf.post("devops?method=/devops/metrics/ms_name_tags").then((function(s){e.serviceNameList=s.map((function(e,t){return{name:e,id:e}})),t.hide(0)})).catch((function(s){t.hide(0),e.$wool.showwarn(s)}))},drawMemory:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,i,n,a,c,m,u,h,d,p,l,v;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return p=function(){return p=Object(r["a"])(regeneratorRuntime.mark((function e(){var s,i,n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=new Date,i=new Date(s.getTime()-18e5),n={end:s,begin:i,name:t.serviceName,no:t.serviceNo},e.next=5,t.$wf.post("devops?method=/devops/metrics/ms_memory_alloc_range",n);case 5:return r=e.sent,e.next=8,t.$wf.post("devops?method=/devops/metrics/ms_memory_used_range",n);case 8:a=e.sent,h(r,"s1"),h(a,"s2");case 11:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)},d=function(){return p.apply(this,arguments)},h=function(e,r){if(e){s=[],"s1"==r&&(i=[]),"s2"==r&&(n=[]);var a=[];t.queryJsTime-t.queryKsTime>2592e5&&t.queryJsTime-t.queryKsTime<6048e5?o("MM-dd hh"):t.queryJsTime-t.queryKsTime>=6048e5?o("YYYY-MM-DD hh:mm"):o("hh:mm")}function o(t){for(var o=1048576,c=0;c<e.length;c++)s.push(e[c].time.format(t)),a.push(Math.floor(e[c].value/o*100)/100);"s1"==r?i=a:n=a}},t=this,s=[],i=[],n=[],a=o.init(document.getElementsByClassName("JVM_box")[0]),c={end:this.queryJsTime,begin:this.queryKsTime,name:this.serviceName,no:this.serviceNo},e.next=11,this.$wf.post("devops?method=/devops/metrics/ms_memory_alloc_range",c);case 11:return m=e.sent,e.next=14,this.$wf.post("devops?method=/devops/metrics/ms_memory_used_range",c);case 14:u=e.sent,h(m,"s1"),h(u,"s2"),l={title:{text:"内存",x:"center",textStyle:{fontSize:15}},tooltip:{trigger:"axis",axisPointer:{animation:!1}},xAxis:{type:"category",splitLine:{show:!1},data:s,boundaryGap:!1},yAxis:{type:"value",boundaryGap:[0,"100%"],splitLine:{show:!1},axisLabel:{formatter:"{value}M"}},series:[{name:"已用内存",type:"line",showSymbol:!1,hoverAnimation:!1,areaStyle:{},data:n},{name:"已分配内存",type:"line",showSymbol:!1,hoverAnimation:!1,areaStyle:{},data:i}],grid:{x:60,y:40,x2:25,y2:50},color:["#E062AE","#3398DB"]},a.setOption(l),this.kaishiTime||(v=setInterval((function(){d(),l.xAxis.data=s,l.series[1].data=i,l.series[0].data=n,a.setOption(l)}),1e4)),this.timerList.push(v);case 21:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),drawJvm:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var s,i,n,a,c,m,u,h,d,p,l,v,_,f,x,y,w,g,b,T,k,q,C,N,$,R;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if($=function(e){e.setOption(N)},C=function(){return C=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,i,r,a,o,c,h,p,v,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=new Date,s=new Date(t.getTime()-18e5),i={end:t,begin:s,name:n.serviceName,no:n.serviceNo},!m){e.next=10;break}return e.next=6,n.$wf.post("devops?method=/devops/metrics/ms_cpu_usage_rate_range",i);case 6:r=e.sent,k(r),e.next=57;break;case 10:if(!u){e.next=17;break}return e.next=13,n.$wf.post("devops?method=/devops/metrics/ms_thread_count_range",i);case 13:a=e.sent,k(a),e.next=57;break;case 17:if(!d){e.next=24;break}return e.next=20,n.$wf.post("devops?method=/devops/metrics/ms_gc_full_count_range",i);case 20:o=e.sent,k(o),e.next=57;break;case 24:if(!l){e.next=31;break}return e.next=27,n.$wf.post("devops?method=/devops/metrics/ms_rpc_request_count_range",i);case 27:c=e.sent,k(c),e.next=57;break;case 31:if(!_){e.next=38;break}return e.next=34,n.$wf.post("devops?method=/devops/metrics/ms_rpc_request_count_error_range",i);case 34:h=e.sent,k(h),e.next=57;break;case 38:if(!x){e.next=45;break}return e.next=41,n.$wf.post("devops?method=/devops/metrics/ms_rpc_request_totalimel_range",i);case 41:p=e.sent,k(p),e.next=57;break;case 45:if(!w){e.next=52;break}return e.next=48,n.$wf.post("devops?method=/devops/metrics/ms_rpc_request_maxl_range",i);case 48:v=e.sent,k(v),e.next=57;break;case 52:if(!b){e.next=57;break}return e.next=55,n.$wf.post("devops?method=/devops/metrics/ms_rpc_current_request_range",i);case 55:f=e.sent,k(f);case 57:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)},q=function(){return C.apply(this,arguments)},k=function(e){function t(t){for(var n=0;n<e.length;n++)s.push(e[n].time.format(t)),i.push(e[n].value)}e&&(s=[],i=[],n.queryJsTime-n.queryKsTime>2592e5&&n.queryJsTime-n.queryKsTime<6048e5?t("MM-dd hh"):n.queryJsTime-n.queryKsTime>=6048e5?t("YYYY-MM-DD hh:mm"):t("hh:mm"))},s=[],i=[],n=this,a={end:this.queryJsTime,begin:this.queryKsTime,name:this.serviceName,no:this.serviceNo},"cpu_box"!=t){e.next=16;break}return e.next=11,this.$wf.post("devops?method=/devops/metrics/ms_cpu_usage_rate_range",a);case 11:c=e.sent,k(c),m=o.init(document.getElementById("cpu_box")),e.next=70;break;case 16:if("thread_box"!=t){e.next=24;break}return u=o.init(document.getElementById("thread_box")),e.next=20,this.$wf.post("devops?method=/devops/metrics/ms_thread_count_range",a);case 20:h=e.sent,k(h),e.next=70;break;case 24:if("GC_box"!=t){e.next=32;break}return d=o.init(document.getElementById("GC_box")),e.next=28,this.$wf.post("devops?method=/devops/metrics/ms_gc_full_count_range",a);case 28:p=e.sent,k(p),e.next=70;break;case 32:if("RPC_pl"!=t){e.next=40;break}return l=o.init(document.getElementById("RPC_pl")),e.next=36,this.$wf.post("devops?method=/devops/metrics/ms_rpc_request_count_range",a);case 36:v=e.sent,k(v),e.next=70;break;case 40:if("RPC_error_num"!=t){e.next=48;break}return _=o.init(document.getElementById("RPC_error_num")),e.next=44,this.$wf.post("devops?method=/devops/metrics/ms_rpc_request_count_error_range",a);case 44:f=e.sent,k(f),e.next=70;break;case 48:if("spend_time"!=t){e.next=56;break}return x=o.init(document.getElementById("spend_time")),e.next=52,this.$wf.post("devops?method=/devops/metrics/ms_rpc_request_totalimel_range",a);case 52:y=e.sent,k(y),e.next=70;break;case 56:if("spendtime_max"!=t){e.next=64;break}return w=o.init(document.getElementById("spendtime_max")),e.next=60,this.$wf.post("devops?method=/devops/metrics/ms_rpc_request_maxl_range",a);case 60:g=e.sent,k(g),e.next=70;break;case 64:if("RPC_num"!=t){e.next=70;break}return b=o.init(document.getElementById("RPC_num")),e.next=68,this.$wf.post("devops?method=/devops/metrics/ms_rpc_current_request_range",a);case 68:T=e.sent,k(T);case 70:N={title:{text:"动态数据 + 时间坐标轴",x:"center",textStyle:{fontSize:15}},tooltip:{trigger:"axis",axisPointer:{animation:!1}},xAxis:{type:"category",splitLine:{show:!1},data:s,boundaryGap:!1},yAxis:{type:"value",boundaryGap:[0,"100%"],splitLine:{show:!1}},series:[{name:"",type:"line",showSymbol:!1,hoverAnimation:!1,areaStyle:{},data:i}],grid:{x:50,y:40,x2:25,y2:50},color:["#3398DB"]},m?(N.title.text="CPU使用率",N.series[0].name="CPU使用率",N.yAxis.axisLabel={formatter:"{value}%"}):u?N.title.text="线程数":d?(N.title.text="GC次数",N.series[0].name="GC次数"):l?(N.title.text="RPC次数",N.series[0].name="次数"):_?(N.title.text="错误次数",N.series[0].name="错误次数"):x?(N.title.text="耗时",N.series[0].name="耗时"):w?(N.title.text="分钟内最大耗时",N.series[0].name="分钟内最大耗时",N.yAxis.axisLabel={formatter:"{value}ms"}):b&&(N.title.text="并发数",N.series[0].name="并发数"),m&&$(m),u&&$(u),d&&$(d),l&&$(l),_&&$(_),x&&$(x),w&&$(w),b&&$(b),this.kaishiTime||(R=setInterval((function(){q(),N.xAxis.data=s,N.series[0].data=i,m?$(m):u?$(u):d?$(d):l?$(l):_?$(_):x?$(x):w?$(w):b&&$(b)}),1e4),this.timerList.push(R));case 81:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),drawEcharts:function(){console.log(this.timerList);for(var e=0;e<this.timerList.length;e++)clearInterval(this.timerList[e]);this.drawMemory(),this.drawJvm("cpu_box"),this.drawJvm("thread_box"),this.drawJvm("GC_box"),this.drawJvm("RPC_pl"),this.drawJvm("RPC_error_num"),this.drawJvm("spend_time"),this.drawJvm("spendtime_max"),this.drawJvm("RPC_num")}},mounted:function(){Date.prototype.Format=function(e){var t=this.getFullYear(),s=this.getMonth()+1;s=s<10?"0"+s:s;var i=this.getDate();i=i<10?"0"+i:i;var n=this.getHours();n=n<10?"0"+n:n;var r=this.getMinutes();r=r<10?"0"+r:r;var a=this.getSeconds();return a=a<10?"0"+a:a,e?t+"-"+s+"-"+i+" "+n+":"+r:t+"-"+s+"-"+i+" "+n+":"+r+":"+a},this.queryJsTime=new Date,this.queryKsTime=new Date(this.queryJsTime.getTime()-18e5),this.$route.query.sn?(this.serviceName=this.$route.query.sn,console.log(this.serviceName),this.changeNo(this.$route.query.no)):this.$route.query&&this.getServiceList()},destroyed:function(){console.log(this.timerList);for(var e=0;e<this.timerList.length;e++)clearInterval(this.timerList[e])}},m=c,u=(s("c2e6"),s("2877")),h=Object(u["a"])(m,i,n,!1,null,"fdffaf68",null);t["default"]=h.exports},"548d":function(e,t,s){},c2e6:function(e,t,s){"use strict";var i=s("548d"),n=s.n(i);n.a}}]);